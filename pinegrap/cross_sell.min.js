software.cross_sell=software.cross_sell||{},software.cross_sell.init=function(t){var e=t.id;e||(e="cross-sell");var o=software_$("#"+e);o.hide();var r=software_$(".items",o);r.hide();var a=(t.number_of_items,t.complete);software.cross_sell.instances=software.cross_sell.instances||{},software.cross_sell.instances[e]={};var i=software.cross_sell.instances[e];return i.attribute_update=t.attribute_update,i.attribute_update&&"undefined"!=typeof software.matched_products?i.products=software.matched_products:i.products=t.products,i.product_group=t.product_group,i.recipient=t.recipient,i.limit=t.limit,i.days=t.days,i.discounted=t.discounted,i.catalog_detail_page=t.catalog_detail_page,i.number_of_items=t.number_of_items,i.in_product_group=t.in_product_group,i.analytics=t.analytics,i.item_content=software_$(".item",o).prop("outerHTML"),r.empty(),"function"!=typeof a&&(a=function(){}),i.complete=a,i.update=function(){var t=JSON.stringify({action:"get_cross_sell_items",products:i.products,product_group:i.product_group,recipient:i.recipient,limit:i.limit,days:i.days,discounted:i.discounted,catalog_detail_page:i.catalog_detail_page,number_of_items:i.number_of_items,in_product_group:i.in_product_group});if(t!==i.api_request){i.api_request=t;var a=software_$.ajax({contentType:"application/json",url:software_path+software_directory+"/api.php",data:t,type:"POST"});a.done(function(t){var a=JSON.stringify(t);if(a!==i.api_response){i.api_response=a;var s=t.items;if(!s)return void o.fadeOut(function(){r.empty()});o.fadeIn();var n=r.fadeOut().promise();n.done(function(){r.empty();var t=!1,o="";if(i.analytics!==!1&&window.ga&&ga.create){t=!0;var a="";"undefined"!=typeof ga.getAll()[0]&&(a=ga.getAll()[0].get("name")),o=a,""!=o&&(o+=".")}software_$.each(s,function(a,s){var n=software_$(i.item_content),c=software_$("a.link",n);c.prop("href",s.url),t&&c.click(function(){ga(o+"send","event",{eventCategory:e,eventAction:"click",eventLabel:s.short_description,transport:"beacon"})}),software_$("img.image",n).prop("src",s.image_url),software_$(".description",n).html(software.h(s.short_description)),software_$(".price",n).html(s.price_info),r.append(n)}),r.fadeIn(function(){i.complete()})})}})}},i.update(),i.attribute_update&&software_$("body").on("attribute_update",function(){i.products=[],software_$.each(software.matched_products,function(t,e){var o={};o.id=e.id,i.products.push(o)}),i.update()}),i};